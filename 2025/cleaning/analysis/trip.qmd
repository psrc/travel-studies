---
title: "Trip"
date: today
---

```{r}
#| include: false

source("functions.R")
tables <- readRDS("analysis_table.RDS")
```

## Trip Info

:::{.panel-tabset}

### User Input

- no `user_added` variable
```{r}
get_vars_summary("trip_unlinked", c("copied_trip","user_split","user_merged"))
```

### Analyst Actions
```{r}
get_vars_summary("trip_unlinked", c("imputed_record_type","imputed_joint_trip","analyst_split","analyst_merged","analyst_split_loop"))
```


### Distance and time

```{r}
CreateTableOne(data = tables[['trip_unlinked']] %>% mutate(duration_minutes = as.numeric(duration_minutes)),
               vars = c("distance_miles","duration_minutes","speed_mph","dwell_mins")
               )
```

### Departure and Arrival Times
```{r}
CreateTableOne(data = tables[['trip_unlinked']],
               vars = c("depart_time_hour","arrival_time_hour"),
               factorVars = c("depart_time_hour","arrival_time_hour")
               )
```

### Completeness
```{r}
get_vars_summary("trip_unlinked", c("hh_day_iscomplete","day_iscomplete","svy_complete"))
```

### Flags
```{r}
get_vars_summary("trip_unlinked", c("flag_teleport","speed_flag"))
CreateTableOne(data = tables[['trip_unlinked']],
               vars = c("transit_quality_flag"),
               factorVars = c("transit_quality_flag")
               )
```


:::

## Travelers

```{r}
get_vars_summary("trip_unlinked", c("driver","travelers_total","travelers_hh","travelers_nonhh"))
```


## Origin/Destination Locations

### In Region
```{r}
get_vars_summary("trip_unlinked", c("d_in_region","o_in_region"), order = FALSE)
```

### By County

```{r}
CreateTableOne(data = tables[['trip_unlinked']],
               vars = c("o_county","d_county")
               )
```


## Trip Mode

- number of responses for `mode_other_specify`: `{r} length(unique(tables[["trip_unlinked"]]$mode_other_specify))`

:::{.panel-tabset}

### Mode Type
```{r}
get_vars_summary("trip_unlinked", c("mode_type"))
```

### Access and Egress Modes
```{r}
get_vars_summary("trip_unlinked", c("is_transit","is_access","is_egress","has_access","has_egress",
                                    "has_synthetic_egress","has_synthetic_access"))
```

```{r}
get_vars_summary("trip_unlinked", c("mode_acc","mode_egr"))
```

### `mode_1`
```{r}
get_vars_summary("trip_unlinked", c("mode_1"))
```

### `mode_2`
```{r}
get_vars_summary("trip_unlinked", c("mode_2"))
```

### `mode_3`
```{r}
get_vars_summary("trip_unlinked", c("mode_3"))
```

### `mode_4`
```{r}
get_vars_summary("trip_unlinked", c("mode_4"))
```

:::



## Trip Purpose
- number of responses for `dest_purpose_other`: `{r} length(unique(tables[["trip_unlinked"]]$dest_purpose_other))`


:::{.panel-tabset}

### RSG Purpose Category
```{r}
get_vars_summary("trip_unlinked", c("origin_purpose_cat","dest_purpose_cat"))
```

### Detailed Origin Purpose

```{r}
get_vars_summary("trip_unlinked", c("origin_purpose"))
```


### Detailed Destination Purpose

```{r}
get_vars_summary("trip_unlinked", c("origin_purpose","dest_purpose"))
```



:::

## Trip Duration and Distance

```{r}
summary(tables[['trip_unlinked']] %>%
          select(all_of(c("duration_minutes","distance_meters","distance_beeline_meters"))))
```

